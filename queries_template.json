{
  "queries": [
    {
      "name": "ezlinks_rounds",
      "description": "EZ Links total rounds from FactBooking (sourcesystemkey = 34)",
      "csv_file": "working-dir/ezlrounds.csv",
      "date_column": "playdatekey",
      "count_column": "rounds_total",
      "base_query": "SELECT playdatekey, SUM(NetRoundsTotal) as rounds_total FROM dbo.FactBooking WHERE sourcesystemkey = 34 GROUP BY playdatekey",
      "filtered_query": "SELECT playdatekey, SUM(NetRoundsTotal) as rounds_total FROM dbo.FactBooking WHERE sourcesystemkey = 34 AND {where_clause} GROUP BY playdatekey",
      "max_date_query": "SELECT MAX(playdatekey) FROM dbo.FactBooking WHERE sourcesystemkey = 34",
      "order_by": "ORDER BY playdatekey",
      "anomaly_threshold_z": -2.5,
      "anomaly_threshold_min": 5000
    },
    {
      "name": "golfnow_rounds",
      "description": "GolfNow total rounds from FactBooking (sourcesystemkey = 1)",
      "csv_file": "working-dir/golfnow_rounds.csv",
      "date_column": "playdatekey",
      "count_column": "rounds_total",
      "base_query": "SELECT playdatekey, SUM(NetRoundsTotal) as rounds_total FROM dbo.FactBooking WHERE sourcesystemkey = 1 GROUP BY playdatekey",
      "filtered_query": "SELECT playdatekey, SUM(NetRoundsTotal) as rounds_total FROM dbo.FactBooking WHERE sourcesystemkey = 1 AND {where_clause} GROUP BY playdatekey",
      "max_date_query": "SELECT MAX(playdatekey) FROM dbo.FactBooking WHERE sourcesystemkey = 1",
      "order_by": "ORDER BY playdatekey",
      "anomaly_threshold_z": -2.5,
      "anomaly_threshold_min": 5000
    },
    {
      "name": "ezlinks_customers",
      "description": "EZ Links new customers created daily (sourcesystemkey = 34)",
      "csv_file": "working-dir/ezlinks_customers.csv",
      "date_column": "CustomerCreatedDate",
      "count_column": "customer_count",
      "base_query": "SELECT CustomerCreatedDate, COUNT(customerKey) as customer_count FROM dbo.DimCustomer WHERE sourcesystemkey = 34 GROUP BY CustomerCreatedDate",
      "filtered_query": "SELECT CustomerCreatedDate, COUNT(customerKey) as customer_count FROM dbo.DimCustomer WHERE sourcesystemkey = 34 AND {where_clause} GROUP BY CustomerCreatedDate",
      "max_date_query": "SELECT MAX(CustomerCreatedDate) FROM dbo.DimCustomer WHERE sourcesystemkey = 34",
      "order_by": "ORDER BY CustomerCreatedDate",
      "anomaly_threshold_z": -2.5,
      "anomaly_threshold_min": 10
    },
    {
      "name": "total_rounds",
      "description": "Total rounds played daily (all sources)",
      "csv_file": "working-dir/total_rounds.csv",
      "date_column": "playdatekey",
      "count_column": "count",
      "base_query": "SELECT {date_column}, {count_column} FROM {table}",
      "filtered_query": "SELECT {date_column}, {count_column} FROM {table} WHERE {where_clause}",
      "max_date_query": "SELECT MAX({date_column}) FROM {table}",
      "order_by": "ORDER BY {date_column}",
      "anomaly_threshold_z": -2.5,
      "anomaly_threshold_min": 5000
    },
    {
      "name": "rounds_by_course",
      "description": "Rounds aggregated by golf course",
      "csv_file": "working-dir/rounds_by_course.csv",
      "date_column": "play_date",
      "count_column": "round_count",
      "base_query": "SELECT {date_column}, SUM({count_column}) as {count_column} FROM courses GROUP BY {date_column}",
      "filtered_query": "SELECT {date_column}, SUM({count_column}) as {count_column} FROM courses WHERE {where_clause} GROUP BY {date_column}",
      "max_date_query": "SELECT MAX({date_column}) FROM courses",
      "order_by": "ORDER BY {date_column}",
      "anomaly_threshold_z": -2.0,
      "anomaly_threshold_min": 1000
    }
  ]
}
